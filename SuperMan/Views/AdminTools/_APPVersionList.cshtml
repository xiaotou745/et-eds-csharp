@model ETS.Data.PageData.PageInfo<Ets.Model.Common.AppVerionModel>
@using ETS.Util;
@using NPOI.SS.Formula.Functions
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="tbstyle">
    <thead>
        <tr class="tdbg">
            <th>编号</th>
            <th>客户端类型</th>
            <th>用户类型</th>
            <th>版本号</th>
            <th>是否强制更新</th>
            <th>更新内容</th>
            <th>发布类型</th>
            <th>发布状态</th>
            <th>发布时间</th>
            <th>操作人</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        @{
            var i = 0;
            if (Model != null && Model.Records.Count > 0)
            {
                foreach (var item in Model.Records)
                {
                    i++;
                    <tr id="@item.ID">
                        <td>@i</td>
                        <td>@(item.PlatForm == 1 ? "Android" : "IOS")</td>
                        <td>@(item.UserType == 1 ? "骑士" : "门店")</td>
                        <td><a href="javascript:void;" onclick="funViewDetail(@item.ID)">@item.Version</a></td>
                        <td>@(item.IsMust == 1 ? "是" : "否")</td>
                        <td title="@item.Message" width="200px">@(item.Message.Length > 15 ? item.Message.Substring(0, 15) +"…": item.Message)</td>
                        <td>@(item.IsTiming == 1 ? "定时发布" : "实时发布")</td>
                        <td>@(item.PubStatus == 0 ? "待发布" : item.PubStatus == 1 ? "已发布" : "取消发布")</td>
                        <td>@item.TimingDate</td>
                        <td>@item.UpdateBy</td>
                        <td>
                            @{
                    if (item.IsTiming == 1 && item.PubStatus == 0)
                    {
                        if (SuperMan.App_Start.UserContext.Current.HasAuthority(73))
                        {
                            <a href="/AdminTools/APPVersionDetail?Id=@item.ID ">编辑</a>
                        }
                        if (SuperMan.App_Start.UserContext.Current.HasAuthority(74))
                        {
                            <a href="javascript:void(0)" onclick="funCancel(@item.ID)">取消发布</a>
                        }
                    }
                    else
                    {
                        if (SuperMan.App_Start.UserContext.Current.HasAuthority(73))
                        {
                            <a href="javascript:void(0)" style="color: gray">编辑</a>
                        }
                        if (SuperMan.App_Start.UserContext.Current.HasAuthority(74))
                        {
                            <a href="javascript:void(0)" style="color: gray">取消发布</a>
                        }
                    }
                            }
                        </td>
                    </tr>
                }
            }
        }
    </tbody>
</table>
@{
    if (Model != null)
    {
        ViewBag.ActionName = "PostAPPVersionManager";
        @Html.Partial("~/views/shared/PagerControl.cshtml", Model)
    }
}

