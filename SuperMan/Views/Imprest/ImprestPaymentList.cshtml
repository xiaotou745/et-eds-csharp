@model ETS.Data.PageData.PageInfo<Ets.Model.DataModel.Finance.ImprestBalanceRecord>
@using ETS.Data.PageData;
@using ETS.Enums;
@using ETS.Extension
@using Ets.Model.DataModel.Finance
@using Webdiyer.WebControls.Mvc;
@{
    ViewBag.Title = "ImprestPaymentList";
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}

<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.8.2.js"></script>
<script src="~/Scripts/jquery-ui-1.8.20.js"></script>
<script src="~/Scripts/jquery.ui.datepicker-zh-CN.js"></script>
<div class="zpManage zpSh">
    <h2 class="crumbs">
        您所在位置 财务管理> 备用金支出
    </h2>
    @using (Ajax.BeginForm("DoImprestPaymentList", new RouteValueDictionary { { "pageindex", "" } },
        new AjaxOptions { UpdateTargetId = "dataList", InsertionMode = InsertionMode.Replace },
        new RouteValueDictionary { { "id", "searchForm" } }))
    {
        <div class="SearchMd">
            <table>
                <tr>
                    <td>
                        <span class="">骑士电话: </span>
                        <input type="text" name="clienterPhoneNo" id="clienterPhoneNo" />
                        <span class="">日期: </span>
                        <input id="txtOptTimeStart" readonly="readonly" type="text" name="OptDateStart" />
                        <span class="">到: </span>
                        <input id="txtOptTimeEnd" readonly="readonly" type="text" name="OptDateEnd" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="submit" value="查询" class="searchBtn" id="btnSearch" />
                        <input type="button" value="导出" class="searchBtn" id="btnExport" onclick="return DaoCHu()" />
                        <input type="button" value="备用金支出" class="searchBtn" id="btnPayment" />
                    </td>
                </tr>
            </table>
        </div>
    }
    <script type="text/javascript" src="/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <div class="bd clearfix" id="dataList">
        @Html.Partial("DoImprestPaymentList", (PageInfo<ImprestBalanceRecord>)ViewBag.PageModels)
    </div>
</div>

@*备用金支出弹窗*@
<div class="ImprestPayOutDiv">
    <div class="add-openbox add-form" id="ImprestPayOutDiv" style="width:500px">
        <h2>
            <p id="addstatusFin">备用金支出</p>
        </h2>
        <fieldset>
            <div class="control-group">
                <label>支出类型:</label>
                <input type="radio" name=""/>
            </div>
            <div class="control-group">
                <label>商家名称</label>
                <input name="businessName" id="businessName" type="text">
            </div>
        </fieldset>
        <p class="btnbox">
            <input value="确认" type="button" id="btnAddBusiness" class="yesBtn" />
            <input value="关闭" type="button" class="J_closebox qxBtn" />
        </p>
    </div>
</div>
<script type="text/javascript">

    $(document).ready(function () {
        $('#txtOptTimeStart').datepicker();
        $('#txtOptTimeEnd').datepicker();
        window.location.hash = '';
    });

    //导出
    function DaoCHu() {
        var clienterPhoneNo = $("#clienterPhoneNo").val();
        var txtOptTimeStart = $("#txtOptTimeStart").val();
        var txtOptTimeEnd = $("#txtOptTimeEnd").val();
        if (txtOptTimeStart == "" || txtOptTimeEnd == "") {
            alert("请输入时间范围!");
            return false;
        }
        var url = "/Imprest/PostDaoChuImprestPayment?ClienterPhoneNo=" + clienterPhoneNo + "&OptDateStart=" + txtOptTimeStart + "&OptDateEnd=" + txtOptTimeEnd + "&OptType=2";
        window.location.href = url;
        return true;
    }
</script>

<script src="~/Scripts/view/MessageManagerList.js" type="text/javascript"></script>
<script src="~/Scripts/mvcpager.js"></script>

