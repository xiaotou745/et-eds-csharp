@model Ets.Model.DataModel.DeliveryCompany.DeliveryCompanyModel
@{
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}

<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.8.2.js"></script>
<script src="~/Scripts/jquery-ui-1.8.20.js"></script>
<script src="~/Scripts/jquery.ui.datepicker-zh-CN.js"></script>
<div style="width:1015px;height:auto;border: 1px #dcdcdc solid"> 
    <h2 class="crumbs">
        配送公司管理 > 配送公司管理 > 修改配送公司信息
    </h2>
    <div class="modifyDeliveryDiv">
        <div class="add-openbox add-form" id="modifyDeliveryDiv" style="width: 500px"> 
            <fieldset>
                <div class="control-group">
                    <label>物流公司Code：</label>
                    <input name="deliveryCompanyCode" id="deliveryCompanyCode" type="text" disabled="disabled" value="@Model.DeliveryCompanyCode" />
                </div>
                <div class="control-group">
                    <label>物流公司名称：</label>
                    <input name="deliveryCompanyName" id="deliveryCompanyName" type="text" value="@Model.DeliveryCompanyName"/>
                </div>
                <div>
                    <label>结算类型：</label>
                    <input id="rDeliveryCheck1" name="rDeliveryCheck" type="radio" value="1" checked="checked" />
                    <label for="rDeliveryCheck1">结算比例</label>
                    <input id="rDeliveryCheck2" name="rDeliveryCheck" type="radio" value="2" />
                    <label for="rDeliveryCheck2">固定金额</label>
                </div>
                <div class="control-group">
                    <label>骑士结算：</label>

                    <input name="clienterSettlementFix" id="clienterSettlementFix" style="display: none" type="text" />
                    <input name="clienterSettlementRatio" id="clienterSettlementRatio" type="text" />
                    <label id="lblClienterSettlement">%</label>

                </div>
                <div class="control-group">
                    <label>物流公司结算：</label>
                    <input name="deliverySettlementFix" id="deliverySettlementFix" style="display: none" type="text" />
                    <input name="deliverySettlementRatio" id="deliverySettlementRatio" type="text" />
                    <label id="lblDeliverySettlement">%</label>
                </div>
            </fieldset>
            <p class="btnbox">
                <input value="修改确认" type="button" id="btnModifyDelivery" class="yesBtn" />
                <input value="关闭" type="button" class="J_closebox qxBtn" />
            </p>
        </div>
    </div>
</div>
 <script>
     $("#btnModifyDelivery").click(function () {
         var deliveryCompanyName = $("#deliveryCompanyName").val();
         var clienterSettlementFix = $("#clienterSettlementFix").val();
         var clienterSettlementRatio = $("#clienterSettlementRatio").val();
         var deliverySettlementFix = $("#deliverySettlementFix").val();
         var deliverySettlementRatio = $("#deliverySettlementRatio").val();
         var deliveryCode = $("#deliveryCompanyCode").val();
         if (deliveryCompanyName == null || deliveryCompanyName == "") {
             alert("物流公司名称!");
             return;
         }
         var decimalFormat = /^[0-9]*(\.[0-9]{1,2})?$/;
         var settleType = $('input[name="rDeliveryCheck"]:checked').val();
         alert(settleType)
         if (settleType == 1) {
             if (clienterSettlementRatio == null || clienterSettlementRatio == "" || deliverySettlementRatio == null || deliverySettlementRatio == "") {
                 alert("骑士结算和物流公司结算必须填写!");
                 return;
             }
             if (!decimalFormat.test(clienterSettlementRatio)) {
                 alert("请输入正确的骑士结算金额！");
                 return;
             }
             if (!decimalFormat.test(deliverySettlementRatio)) {
                 alert("请输入正确的物流公司金额！");
                 return;
             }
         } else {
             alert(clienterSettlementFix);
             alert(deliverySettlementFix);

             if (clienterSettlementFix == null || clienterSettlementFix == "" || deliverySettlementFix == null || deliverySettlementFix == "") {
                 alert("骑士结算和物流公司结算必须填写!");
                 return;
             }
             if (!decimalFormat.test(clienterSettlementFix)) {
                 alert("请输入正确的骑士结算金额！");
                 return;
             }
             if (!decimalFormat.test(deliverySettlementFix)) {
                 alert("请输入正确的物流公司金额！");
                 return;
             }
         }
         var paramaters = { "SettleType": settleType, "DeliveryCompanyName": deliveryCompanyName, "DeliveryCompanyCode": deliveryCode, "ClienterFixMoney": clienterSettlementFix, "ClienterSettleRatio": clienterSettlementRatio, "DeliveryCompanySettleMoney": deliverySettlementFix, "DeliveryCompanyRatio": deliverySettlementRatio };
         var url = "/DeliveryCompany/ModifyDeliveryCompany";
         $.ajax({
             type: 'POST',
             url: url,
             data: paramaters,
             success: function (result) {
                 if (result.IsSuccess) {
                     alert("修改成功!");
                     window.location.href = "/DeliveryCompany/DeliveryCompany";
                 } else {
                     alert(result.Message);
                 }
             }
         });
     });
     $('input[name="rDeliveryCheck"]').click(function () {
         var a = $('input[name="rDeliveryCheck"]:checked').val();
         if (a == 1) {  //结算比例
             $("#clienterSettlementFix").val('');
             $("#deliverySettlementFix").val('');

             $("#clienterSettlementFix").hide();
             $("#deliverySettlementFix").hide();

             $("#clienterSettlementRatio").show();
             $("#deliverySettlementRatio").show();
             $("#lblClienterSettlement").html("%");
             $("#lblDeliverySettlement").html("%");
         } else {
             $("#clienterSettlementRatio").show();
             $("#deliverySettlementRatio").show();

             $("#clienterSettlementFix").val('');
             $("#deliverySettlementFix").val('');
             $("#clienterSettlementFix").hide();
             $("#deliverySettlementFix").hide();
             $("#lblClienterSettlement").html("元/单");
             $("#lblDeliverySettlement").html("元/单");
         }
     });
    
</script>
 


