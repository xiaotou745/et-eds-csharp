@model Ets.Model.DataModel.DeliveryCompany.DeliveryCompanyModel
@{
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}

<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet"/>
<script src="~/Scripts/jquery-1.8.2.js"></script>
<script src="~/Scripts/jquery-ui-1.8.20.js"></script>
<script src="~/Scripts/jquery.ui.datepicker-zh-CN.js"></script>
<div style="width:1015px;height:auto;border: 1px #dcdcdc solid">
    <h2 class="crumbs">
        配送公司管理 > 配送公司管理 > 修改配送公司信息
    </h2>
    <div style="width: 750px; height: auto; border-bottom: solid 0px #dcdcdc; padding-left: 10px;">
        <input name="deliveryCompanyId" id="deliveryCompanyId" type="hidden" value="@Model.Id" />
        <div class="control-group" style="margin-top: 10px">
            <label>配送公司Code：</label>
            <input name="deliveryCompanyCode" id="deliveryCompanyCode" type="text" disabled="disabled" value="@Model.DeliveryCompanyCode" />
        </div>
        <div class="control-group">
            <label>配送公司名称：</label>
            <input name="deliveryCompanyName" id="deliveryCompanyName" type="text" value="@Model.DeliveryCompanyName"/>
            <input name="deliveryCompanyOldName" id="deliveryCompanyOldName" type="hidden" value="@Model.DeliveryCompanyName" />

        </div>
        <div class="control-group">
            <label>结算类型：</label>
            <input id="rDeliveryCheck1" name="rDeliveryCheck" type="radio" value="1" @(Model.SettleType == 1 ? "checked" : "") />
            <label for="rDeliveryCheck1">结算比例</label>
            <input id="rDeliveryCheck2" name="rDeliveryCheck" type="radio" value="2" @(Model.SettleType == 2 ? "checked" : "") />
            <label for="rDeliveryCheck2">固定金额</label>
        </div>
        <div class="control-group">
            <label>是否显示骑士账户模块：</label>
            <input id="rIsShowAccount1" name="rIsShowAccount" type="radio" value="0" @(Model.IsShowAccount == 0 ? "checked" : "") />
            <label for="rIsShowAccount1">不显示</label>
            <input id="rIsShowAccount2" name="rIsShowAccount" type="radio" value="1" @(Model.IsShowAccount == 1 ? "checked" : "") />
            <label for="rIsShowAccount2">显示</label>
        </div>
        <div class="control-group">
            <label>骑士结算：</label>
            @if (Model.SettleType == 1)
            {
                <input name="clienterSettlement" id="clienterSettlement" type="text" value="@Model.ClienterSettleRatio" />
            }
            else
            {
                <input name="clienterSettlement" id="clienterSettlement" type="text" value="@Model.ClienterFixMoney" />
            }
            <label id="lblClienterSettlement">@(Model.SettleType == 2 ? "元/单" : "%")</label>
        </div>
        <div class="control-group">
            <label>配送公司结算：</label>
            @if (Model.SettleType == 1)
            {
                <input name="deliverySettlement" id="deliverySettlement" type="text" value="@Model.DeliveryCompanyRatio" />
            }
            else
            {
                <input name="deliverySettlement" id="deliverySettlement" type="text" value="@Model.DeliveryCompanySettleMoney" />
            }
            <label id="lblDeliverySettlement">@(Model.SettleType == 2 ? "元/单" : "%")</label>
        </div>
        @*<div class="control-group">
            <label>是否启用：</label>
            <input id="rDeliveryIsEnable1" name="rDeliveryIsEnableCheck" type="radio" value="1" @(Model.IsEnable == 1 ? "checked" : "")/>
            <label for="rDeliveryIsEnable1">启用</label>
            <input id="rDeliveryIsEnable0" name="rDeliveryIsEnableCheck" type="radio" value="0" @(Model.IsEnable == 0 ? "checked" : "")/>
            <label for="rDeliveryIsEnable0">不启用</label>
        </div>*@
        <div class="control-group" style="margin-top: 5px">
            <input value="修改确认" type="button" id="btnModifyDelivery" class="yesBtn" style="margin-right: 20px" />
            <input value="返回" type="button" class="J_closebox qxBtn" id="goBackDelivery" />
        </div>
    </div>
</div>
<script>
    $("#btnModifyDelivery").click(function () {
        var deliveryCompanyName = $("#deliveryCompanyName").val();
        var clienterSettlement = $("#clienterSettlement").val();
        var deliverySettlement = $("#deliverySettlement").val();
        var deliveryCompanyId = $("#deliveryCompanyId").val();
        var deliveryCompanyOldName = $("#deliveryCompanyOldName").val();
        if ( deliveryCompanyName == "") {
            alert("配送公司名称为空!");
            return;
        }
        var decimalFormat = /^[0-9]*(\.[0-9]{1,3})?$/;
        var settleType = $('input[name="rDeliveryCheck"]:checked').val();
        var isShowAccount = $('input[name="rIsShowAccount"]:checked').val();
       // var isEnable = $('input[name="rDeliveryIsEnableCheck"]:checked').val();

        if (clienterSettlement == "" || deliverySettlement == "") {
            alert("骑士结算和配送公司结算必须填写!");
            return;
        }
        if (!decimalFormat.test(clienterSettlement)) {
            alert("请输入正确的骑士结算金额！");
            return;
        }
        if (!decimalFormat.test(clienterSettlement)) {
            alert("请输入正确的配送公司金额！");
            return;
        }
        var paramaters = { "Id": deliveryCompanyId, "SettleType": settleType, "DeliveryCompanyName": deliveryCompanyName, "DeliveryCompanyOldName": deliveryCompanyOldName, "ClienterSettle": clienterSettlement, "DeliveryCompanySettle": deliverySettlement, "IsShowAccount": isShowAccount };//, "IsEnable": isEnable 
        var url = "/DeliveryCompany/ModifyDeliveryCompany";
        $.ajax({
            type: 'POST',
            url: url,
            data: paramaters,
            success: function (result) {
                if (result.IsSuccess) {
                    alert(result.Message);
                    window.location.href = "/DeliveryCompany/DeliveryCompany";
                } else {
                    alert(result.Message);
                }
            }
        });
    });
    $('input[name="rDeliveryCheck"]').click(function () {
        var a = $('input[name="rDeliveryCheck"]:checked').val();
        if (a == 1) {  //结算比例
            $("#lblClienterSettlement").html("%");
            $("#lblDeliverySettlement").html("%");
        } else {
            $("#lblClienterSettlement").html("元/单");
            $("#lblDeliverySettlement").html("元/单");
        }
    });

    $("#goBackDelivery").click(function() {
        window.history.go(-1);
    });

</script>



